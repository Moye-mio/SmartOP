# Vertex Color To Texture
## 功能目的：
根据**原始点云模型**与重建后**带纹理坐标的三角网格模型**，生成该网格模型的纹理贴图。
 
## 功能的输入与输出：
输入：点云模型（.pcd .ply格式） 、带有纹理坐标的网格模型（.obj格式）

输出：纹理贴图（.png格式）

## 功能的基本思想
&emsp;&emsp; 通常来说，生成一张纹理贴图，就是要确定其中每一个纹素的颜色。而对于一个已经生成纹理坐标的网格模型来说，其对应的纹理贴中纹素的中心位置是可以确定在哪个网格内的（假定每个网格纹理坐标不重叠）。进而可以通过重心坐标关系推算出该纹素中心在世界坐标中的位置。

&emsp;&emsp; 得到纹素中心在世界坐标中位置后，需要计算纹素的颜色。参照Surface Splatting思想，在纹素中心位置沿面法线正反方向发射射线，与点云面片求交混合计算颜色。

## 方法流程

1. 输入点云模型、网格模型

2. 对于网格模型中每一个网格

    &emsp;&emsp;根据顶点纹理坐标，确定在其中的纹素中心，如果存在，计算它们的重心坐标。根据重心坐标反算出纹素中心在世界空间中的坐标。

3. 对于每一个世界空间中的纹素中心

    &emsp;&emsp;以其为起点，沿面法线正负方向发射射线，与周围的点云面片求交。交点存在0，1，n几种情况。对于存在n个交点，两两计算交点与最近交点距离l，若l<ε(距离阈值)则该交点所在面片颜色需要加入到最终颜色加权运算中去。最后得到该纹素颜色。
<div  align="center">    
    <img src="https://img-blog.csdnimg.cn/20210902111012379.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5Y2X5pyb5bGx6LCt5paH5paH,size_20,color_FFFFFF,t_70,g_se,x_16" width = "400" height = "300" />
</div>
    
4. 输出纹理贴图
